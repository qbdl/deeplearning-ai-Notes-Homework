

å´æ©è¾¾Deep Learning å­¦ä¹ ç¬”è®°



## 1ã€Logstic Regression(å›å½’)

#### 1ã€ç†è§£w=w-Î± *df/dw ä¸ºä»€ä¹ˆæ˜¯è¿™æ ·?

https://zhuanlan.zhihu.com/p/86147140

â€‹	ç”±äºæ¢¯åº¦æ–¹å‘ï¼ˆdf/dxï¼Œdf/dyï¼Œdf/dw ...ï¼‰æ˜¯å‡½æ•°å˜åŒ–æœ€å¿«çš„æ–¹å‘ï¼ˆé€šè¿‡æœ€å¤§æ—¶å¤¹è§’å€¼å¾—å‡ºï¼‰

[ä»ä¸ºä»€ä¹ˆæ¢¯åº¦æ–¹å‘æ˜¯å‡½æ•°å˜åŒ–ç‡æœ€å¿«æ–¹å‘è¯¦è°ˆæ¢¯åº¦ä¸‹é™](https://zhuanlan.zhihu.com/p/420701835)

â€‹	æ‰€ä»¥æ¯ä¸ªå˜é‡åˆ†åˆ«å–æ¢¯åº¦é‡Œå¯¹åº”çš„å˜åŒ–é‡ï¼Œæ•´ä½“å°±æ²¿ç€ä¸‹é™é€Ÿåº¦æœ€å¿«çš„æ–¹å‘å»äº†ã€‚

â€‹	ç„¶ååŠ ä¸Šä¸€ä¸ªå­¦ä¹ ç‡æ¥æ§åˆ¶æ­¥é•¿å³å¯ã€‚

#### 2ã€å®Œæ•´å½¢å¼

<img src="./assets/image-20230712161422375.png" alt="image-20230712161422375" style="zoom: 67%;" />



ä¸€äº›ç®€å•çš„æ¨å¯¼ï¼ˆæ­¤æ—¶å‡è®¾ä¸ºå•ä¸ªæ ·æœ¬ï¼‰ï¼š

<img src="./assets/image-20230713111501224.png" alt="image-20230713111501224" />

![image-20230713111518935](./assets/image-20230713111518935.png)



<img src="./assets/image-20230712203416625.png" alt="image-20230712203416625" style="zoom: 80%;" />

å…¶ä¸­ï¼ŒX=ï¼ˆx(1),x(2)...) , Xçš„æ¯ä¸€åˆ—éƒ½æ˜¯ä¸€ä¸ªæ ·æœ¬

<img src="./assets/image-20230712150623806.png" alt="image-20230712150623806" style="zoom:67%;" />





ç¼–ç¨‹Tips : ä½¿ç”¨å‘é‡åŒ–æ›¿ä»£foråŠ å¿«é€Ÿåº¦ï¼Œåˆ©ç”¨å¹¿æ’­ï¼ˆå¤åˆ¶è‡³åŒè§„æ¨¡ï¼‰



## 2ã€å¤šç§æ¿€æ´»å‡½æ•°

**Sigmoid** : **å¸¸ç”¨ä½œæœ€åä¸€å±‚äºŒåˆ†ç±»çš„æ¿€æ´»å‡½æ•°**ï¼Œä½†å…¶ä»–åœ°æ–¹ä¸å¸¸ç”¨ï¼Œå­˜åœ¨æ¢¯åº¦æ¶ˆå¤±
$$
a=\sigma(z)=\frac{1}{1+e^{-z}}
$$

$$
å¯¼æ•°=a'(z)=a(1-a)
$$

**tanh**:  æ€»ä½“ä¸Šéƒ½ä¼˜äºsigmoidå‡½æ•°çš„æ¿€æ´»å‡½æ•°ï¼Œ**å‡ ä¹é€‚åˆæ‰€æœ‰åœºåˆ**ï¼Œå­˜åœ¨æ¢¯åº¦æ¶ˆå¤±
$$
a=tanh(z)=\frac{e^z-e^{-z}}{e^z+e^{-z}}
\\ å¯¼æ•°= a'(z)=1-(tanh(z))^2
$$
**Relu(Rectified Linear Unit) :** **æœ€å¸¸ç”¨çš„é»˜è®¤å‡½æ•°**ï¼Œè§£å†³æ¢¯åº¦æ¶ˆå¤±é—®é¢˜

â€‹																ğ‘ = ğ‘šğ‘ğ‘¥(0, ğ‘§)

**Leaky Relu: **Reluçš„æ”¹è¿›
$$
y = max(0, x) + leak*min(0,x) \\ leakæ˜¯ä¸€ä¸ªå¾ˆå°çš„å¸¸æ•°
$$
<img src="./assets/image-20230714135748395.png" alt="image-20230714135748395" style="zoom: 33%;" />



## 3ã€æ¢¯åº¦ä¸‹é™æ³•

[æœ‰å…³å‘é‡ï¼ŒçŸ©é˜µçš„æ±‚å¯¼ å®šä¹‰ä¸æ¨å¯¼](https://zhuanlan.zhihu.com/p/371234412?ivk_sa=1024320u)

å…¶å®ï¼Œæ±‚å¯¼å®šä¹‰æ¯”è¾ƒå¯ä»¥ç›´è§‚ç†è§£ï¼šå³æœ¬æ¥è¦ä¸€ä¸ªä¸€ä¸ªæ±‚å¯¼ï¼Œä¸ºäº†æ–¹ä¾¿ï¼Œåˆæˆä¸€ä¸ªæ•´ä½“è¿›è¡Œæ±‚å¯¼ï¼Œæ‰€ä»¥å®šä¹‰ä¹Ÿå°±æ˜¯ä¸€ä¸ªä¸€ä¸ªçš„å¯¼æ•°æ‹¼æ¥è€Œæˆå³å¯ã€‚



#### ç¥ç»ç½‘ç»œå‰å‘ä¼ é€’ï¼Œåå‘ä¼ æ’­ å‘é‡åŒ– æ¨å¯¼ï¼š

æœ€åŸºæœ¬çš„å•å…ƒå°±æ˜¯Loggistic Regressionçš„å•å…ƒ  

##### ç¤ºæ„å›¾ï¼š

ï¼ˆå®é™…å®ç°ä¸Šä¸€èˆ¬ä»…æœ€åä¸€å±‚ä½¿ç”¨sigmoidæ¿€æ´»å‡½æ•°æ¥ä½œåˆ†ç±»ï¼Œå…¶ä»–å±‚ä¸€èˆ¬ä¸ç”¨sigmoidå‡½æ•°ï¼Œæš‚è®°ä½œg(x))

![image-20230822120134270](./assets/image-20230822120134270.png)

##### å‰å‘ä¼ é€’å…¬å¼å¦‚ä¸Š

æ³¨æ„å›¾ä¸­çš„æ¯ä¸€ä¸ªèŠ‚ç‚¹å®é™…ä¸Šæ˜¯mä¸ªèŠ‚ç‚¹(å½“è€ƒè™‘å‘é‡åŒ–å¤„ç†çš„æ—¶å€™ï¼Œå³æ¯ä¸ªæ ·æœ¬ç»è¿‡çš„ç½‘ç»œæ˜¯ä¸€æ ·çš„)

##### åå‘ä¼ æ’­(BP)å…¬å¼æ¨å¯¼

###### 	ä¸€äº›ç¬¦å·:

$$
\begin{align*}
& \quad n^{[x]}è¡¨ç¤ºç¬¬nå±‚èŠ‚ç‚¹ä¸ªæ•°ï¼Œè¾“å…¥å±‚ä¸ç®—è¿›å±‚æ•°é‡Œï¼Œæ­¤æ—¶ä¸€å…±æ˜¯ä¸¤å±‚ã€‚\\
& \quad W^{[x]},b^{[x]}ä¸º\textbf{çº¿æ€§ç»„åˆçš„ç³»æ•°ï¼Œç»´åº¦ä¸å—åˆ°æ ·æœ¬æ•°çš„å½±å“}ã€‚\\
& \quad xè¡¨ç¤ºä¸€æ‰¹æ¬¡çš„æ ·æœ¬,ä¹Ÿå°±æ˜¯n^{[0]}çš„ä¸ªæ•°ã€‚\\
& \quad æŸå¤±å‡½æ•°Lè¿™é‡Œä½¿ç”¨äºŒåˆ†ç±»çš„æŸå¤±å‡½æ•°=-[ylog \hat{y}+(1-y)log(1-\hat{y})]
\end{align*}
$$



###### 	è§„æ¨¡è¯´æ˜ï¼š

$$
\begin{align*}
& \quad n^{[x]}è¡¨ç¤ºç¬¬nå±‚èŠ‚ç‚¹ä¸ªæ•°ï¼Œè¾“å…¥å±‚ä¸ç®—è¿›å±‚æ•°é‡Œï¼Œæ­¤æ—¶ä¸€å…±æ˜¯ä¸¤å±‚ã€‚\\
& \quad z^{[x]}ï¼Œa^{[x]}ä¸ºn^{[x]} \times må¤§å°çš„çŸ©é˜µ(mä¸ºæ ·æœ¬ä¸ªæ•°,å³å¯¹äºæ¯ä¸€ä¸ªæ ·æœ¬ï¼Œéƒ½æœ‰n^{[x]} \times 1çš„ç»“æœ)ï¼Œè¾“å…¥Xä¸ºn^{[0]} \times m,å…¶ä¸­n^{[0]}ä¸ºè¾“å…¥ç‰¹å¾çš„ç»´åº¦ï¼Œ\\
& Yä¸ºn_y \times m,å…¶ä¸­n_yä¸ºè¾“å‡ºç‰¹å¾çš„ç»´åº¦ï¼ˆè‹¥ä¸ºäºŒåˆ†ç±»ï¼Œåˆ™åªéœ€è¾“å‡ºæ˜¯/å¦ï¼Œç»´åº¦ä¸º1ï¼‰\\
& \quad W^{[x]}çœ‹æˆæ˜¯è¡Œå‘é‡çš„ç»„åˆï¼Œä¾‹å¦‚
W^{[2]}ä¸ºn^{[2]} \times n^{[1]}å¤§å°çš„çŸ©é˜µï¼Œè®°ä½œ\\
&W^{[2]}=\left(\begin{matrix}
 W^{[2](1)}\\
 W^{[2](2)}\\
 W^{[2](3)}\\
 .. \\
 W^{[2](n^{[2]})}
\end{matrix}\right)
ï¼Œå…¶ä¸­W^{[2](i)}è¡¨ç¤ºå¯¹äºç¬¬äºŒå±‚ç¬¬iä¸ªèŠ‚ç‚¹çš„Wæƒé‡ç»„åˆã€‚
\end{align*}\\
$$







###### 	æ¨å¯¼ï¼š

**å¤šæ ·æœ¬è¿˜ä¸çŸ¥é“è¯¥æ€ä¹ˆè¡¨ç¤ºæ±‚å¯¼ç­‰è¿ç®—ï¼Œåªèƒ½ç­‰åç»­æ•°å­¦æ›´å¥½çš„æ—¶å€™è¡¥ä¸Šäº†!!!**

è€Œä¸”æ¨å‡º1/mçš„ä½ç½®è·Ÿè¯¾ç¨‹é‡Œç»™çš„ä¹Ÿä¸å¤§ä¸€æ ·ï¼Œä¹Ÿä¸çŸ¥é“è°å¯¹äº†ï¼Œå¸Œæœ›æ˜¯æˆ‘å¯¹ï¼



**ä¸€äº›å‰ç½®æ¨å¯¼/çŸ¥è¯†ï¼š**
$$
y=\frac{1}{1+e^{-x}},æ˜“è¯å¾—y'(x)=y(1-y)\\
ä¸€ä¸ªæ•°å¯¹å‘é‡æ±‚å¯¼=è¯¥æ•°å¯¹å‘é‡å„åˆ†é‡æ±‚å¯¼åæ‹¼æ¥
$$
**æ­£å¼æ¨å¯¼ï¼š**
$$
\begin{align*}
&\textbf{æŸå¤±å‡½æ•° J= æ‰€æœ‰æ ·æœ¬å¹³å‡æŸå¤±} = \frac{1}{m}\sum_{i=1}^m L(a^{[2](i)},y^{[i]})
=\frac{1}{m}\sum_{i=1}^m -(y^{(i)}log\hat{y}^{(i)}+(1-y^{(i)})log(1-\hat{y}^{(i)}))\\
&å…¶ä¸­iè¡¨ç¤ºç¬¬iä¸ªæ ·æœ¬ï¼Œy^{(i)}ä¸\hat{y}^{(i)}è¡¨ç¤ºå¯¹äºç¬¬iä¸ªæ ·æœ¬çš„å®é™…äºŒåˆ†ç±»ä¸è¾“å‡ºäºŒåˆ†ç±»ç»“æœã€‚\\
&=\frac{1}{m}\sum_{i=1}^m -(y^{(i)}loga^{[2](i)}+(1-y^{(i)})log(1-a^{[2](i)}))\\
&=-\frac{1}{m}(yloga^{[2]}+(1-y)log(1-a^{[2]}))â€”â€”å‘é‡åŒ–å½¢å¼,\quad å¤§å°: 1\times 1\\
\end{align*}
$$

**ç¬¬äºŒå±‚ï¼š**
$$
\begin{align*}

\\ &\textbf{å•ä¸ªæ ·æœ¬:}å¯¹æ¯ä¸ªç¥ç»å…ƒæ±‚å¯¼ï¼Œæ¯ä¸ªç»“æœè®°å½•åœ¨å¯¹åº”è¡Œï¼Œè¡Œé—´æ— å…³ç³»ã€‚\\
&\quad \frac{dJ}{da^{[2](i)}}=-\frac{1}{m}[\frac{y^{(i)}}{a^{[2](i)}}-\frac{1-y^{(i)}}{1-a^{[2](i)}}] \quad => \quad \frac{dJ}{da^{[2]}}=-\frac{1}{m}[\frac{y}{a^{[2]}}-\frac{(1-y)}{(1-a^{[2]})}]  ,\quad å¤§å°: n^{[2]}\times 1\\
& \textbf{å¤šä¸ªæ ·æœ¬:}ç”±äºä¸åŒæ ·æœ¬é—´ä¸ä¼šäº’ç›¸å½±å“ï¼Œå„è‡ªç®—å„è‡ªçš„ï¼Œæ‰€ä»¥ç›´æ¥å †å å³å¯ï¼Œç”±äºyä¸ºn^{[2]}\times mï¼Œæ‰€ä»¥æœ€ç»ˆç»´åº¦ä¸ºn^{[2]}\times m\\
\\
\\&ç”±äºæ¯ä¸ªz^{[2](i)}æ˜¯åˆ†åˆ«é€šè¿‡å½±å“å¯¹åº”çš„a^{[2](i)}æ¥å½±å“Jçš„ï¼Œæ‰€ä»¥æ±‚å¯¼æ—¶å¯ä»¥åˆ†å¼€æ±‚å¯¼ï¼Œç„¶åæ‹¼èµ·æ¥ï¼

\\& \quad \frac{dJ}{dz^{[2](i)}}=\frac{dJ}{da^{[2](i)}}\frac{da^{[2](i)}}{dz^{[2](i)}}
=-\frac{1}{m}(\frac{y^{(i)}}{a^{[2](i)}}-\frac{1-y^{(i)}}{1-a^{[2](i)}})a^{[2](i)}(1-a^{[2](i)})
=\frac{1}{m}(a^{[2](i)}-y^{(i)}),
\\&=> \frac{dJ}{dz^{[2]}}=\frac{1}{m}(a^{[2]}-y),\quad å¤§å°: n^{[2]}\times 1
\\& => å¯¹äºå¤šä¸ªæ ·æœ¬æ—¶:a^{[2]}ä¸yçš„ç»´åº¦éƒ½ä¹˜ä»¥m,ä½†æ•´ä¸ªè®¡ç®—è¿‡ç¨‹ä¸å˜ï¼Œä¹Ÿæ˜¯å †å ï¼Œå¤§å°: n^{[2]}\times m
\\

\end{align*}
$$

$$
\begin{align*}

\\& ç”±äºæ¯ä¸ªW^{[2](i)}æ˜¯é€šè¿‡å½±å“å¯¹åº”çš„z^{[2](i)}æ¥å½±å“Jçš„ï¼Œæ‰€ä»¥æ±‚å¯¼æ—¶åŒæ ·å¯ä»¥åˆ†ç¦»æ¥æ±‚ã€‚
\\å³
\\& \quad \frac{dJ}{dW^{[2](i)}}=\frac{dJ}{dz^{[2](i)}}\frac{dz^{[2](i)}}{dW^{[2](i)}}
\\
\\&åŒæ—¶ï¼Œ\left(\begin{matrix}
 W^{[2](1)}\\
 W^{[2](2)}\\
 ..\\
 W^{[2](i)}\\
 .. \\
\end{matrix}\right)
\left( a^{[1]}\right)=\left(\begin{matrix}
 z^{[2](1)}\\
 z^{[2](2)}\\
 ..\\
 z^{[2](i)}\\
 .. \\
\end{matrix}\right),å…¶ä¸­a^{[1]}ä¸ºè¯¥å±‚é’ˆå¯¹ä»»ä¸€èŠ‚ç‚¹ç»Ÿä¸€çš„è¾“å…¥ï¼Œå³z^{[2](i)}=W^{[2](i)}a^{[1]}+b^{[2](i)},\\
&è¿›ä¸€æ­¥å±•å¼€ï¼Œ\\
&z^{[2](i)}=W^{[2](i)(1)}a^{[1](1)}+W^{[2](i)(2)}a^{[1](2)}+...,(ç”±äºæ˜¯å¯¹Wæ±‚å¯¼ï¼Œæ‰€ä»¥è¿™é‡Œå°±å¿½ç•¥bçš„é¡¹ï¼Œä¸å½±å“æ±‚å¯¼ç»“æœ)\\
&æ‰€ä»¥ï¼Œ
\frac{dz^{[2](i)}}{dW^{[2](i)}}
=\left(\begin{matrix}
\frac{dz^{[2](i)}}{dW^{[2](i)(1)}} & .. & \frac{dz^{[2](i)}}{dW^{[2](i)(j)}}  & ..
\end{matrix}\right)
=\left(\begin{matrix}
 a^{[1](1)} &  a^{[1](2)} & ..  & a^{[1](j)} & ..\\
\end{matrix}\right)(ç”±äºW^{[2](i)}ä¸º1\times n^{[1]}å¤§å°ï¼Œz^{[2](i)}ä¸º1\times 1,æ‰€ä»¥ç»“æœå¤§å°å³ä¸º1\times n^{[1]}ï¼Œå³a^{[1](i)}çš„æ’åˆ—æ–¹å¼ä¸ºæ¨ªç€æ’åˆ—çš„)\\
&={a^{[1]}}^T
\\& æ‰€ä»¥ï¼Œ
\\
&\quad \frac{dJ}{dW^{[2](i)}}=\frac{dJ}{dz^{[2](i)}}\frac{dz^{[2](i)}}{dW^{[2](i)}}
=\frac{1}{m}(a^{[2]}-y){a^{[1]}}^T \quad => \quad \frac{dJ}{dW^{[2]}}=\frac{1}{m}(a^{[2]}-y){a^{[1]}}^T
=\frac{dJ}{dz^{[2]}} {a^{[1]}}^T,
\quad å¤§å°: (n^{[2]}\times 1) , (1 \times n^{[1]})\\
\\ &å¤šæ ·æœ¬æ—¶: å¤§å°: (n^{[2]}\times m) , (m \times n^{[1]})\\
\\

\end{align*}
$$

$$
\begin{align*}

\\& Jå—æ¯ä¸ªz^{[2](i)}å½±å“(è¯¥å±‚å¤šä¸ªèŠ‚ç‚¹),è€Œæ¯ä¸ªz^{[2](i)}åˆ†åˆ«æ”¶åˆ°b^{[2](i)}å½±å“ï¼Œå³b^{[2](i)}ä¼šå½±å“åˆ°å„ä¸ªz^{[2](i)}è¿›è€Œå½±å“J,æ‰€ä»¥æ˜¯ç´¯åŠ b^{[2](i)}å¯¹æ¯ä¸ªz^{[2](i)}åˆ°Jçš„å½±å“ã€‚
\\& æ‰€ä»¥,\frac{dJ}{db^{[2](i)}}=\sum_j\frac{dJ}{dz^{[2](j)}}\frac{dz^{[2](j)}}{db^{[2](i)}}=\frac{dJ}{dz^{[2](i)}}(ç”±äºz^{[2](i)}=W^{[2](i)(1)}a^{[1](1)}+W^{[2](i)(2)}a^{[1](2)}+...+b^{[2](i)},æ‰€ä»¥\frac{dz^{[2](i)}}{db^{[2](i)}}=1)
\\& \quad æ‰€ä»¥,\frac{dJ}{db^{[2]}}=\frac{dJ}{dz^{[2]}},
\quad å¤§å°: n^{[2]}\times 1\\
&\quad å¤šæ ·æœ¬æ—¶ï¼Œdz^{[2]}çš„ç»´åº¦ä¹˜ä»¥mï¼Œä½†bçš„ç»´åº¦ä¿æŒä¸å˜ï¼Œæ‰€ä»¥éœ€è¦å¯¹æ ·æœ¬åŠ æƒæ¥é™ä½ç»´åº¦=\frac{1}{m}np.sum(dz^{[2]},axis=1,keepdims=True)

\end{align*}
$$
â€‹	

**ç¬¬ä¸€å±‚ï¼š**
$$
\begin{align*}

& ç”±äºa^{[1]}å¯¹Jçš„å½±å“æ˜¯é€šè¿‡å„ä¸ªz^{[2](i)}äº§ç”Ÿçš„ï¼Œæ‰€ä»¥æ±‚å¯¼ï¼ˆå˜åŒ–ç‡ï¼‰æ—¶æ˜¯ç´¯åŠ æ•ˆæœã€‚\\
&\quad \frac{dJ}{da^{[1]}}=\sum_i \frac{dJ}{dz^{[2](i)}} \frac{dz^{[2](i)}}{da^{[1]}},
\\
\\& ç”±äºz^{[2](i)}=W^{[2](i)(1)}a^{[1](1)}+W^{[2](i)(2)}a^{[1](2)}+...+b^{[2](i)}=\sum_j W^{[2](i)(j)}a^{[1](j)}+b^{[2](i)},
\\& æ‰€ä»¥\frac{dz^{[2](i)}}{da^{[1](j)}}=W^{[2](i)(j)}ï¼ˆæ ‡é‡å¯¹æ ‡é‡å¯¼ï¼‰,å¾—
\frac{dz^{[2](i)}}{da^{[1]}}=

\left(\begin{matrix}
 W^{[2](i)(1)}\\
 W^{[2](i)(2)}\\
 ..\\
\end{matrix}\right)={W^{[2](i)}}^T,å³Wçš„ç¬¬iè¡ŒæŒ‰åˆ—æ¥æ’ï¼Œ
\\&æ‰€ä»¥ï¼Œ
\\& \quad \frac{dz^{[2](i)}}{da^{[1]}}
=\left(\begin{matrix}
 W^{[2](1)(1)} & .. & W^{[2](i)(1)} & ..& W^{[2](..)(1)}\\
 .. & .. & .. & ..  & ..\\
 .. & .. & .. & ..  & ..\\
\end{matrix}\right)
={W^{[2]}}^T
\\&ä»è€Œï¼Œ
\\& \quad \frac{dJ}{da^{[1]}}=\sum_i \frac{dJ}{dz^{[2](i)}} \frac{dz^{[2](i)}}{da^{[1]}}
=\frac{1}{m} \sum_i (a^{[2](i)}-y^{(i)})\left(\begin{matrix}
 W^{[2](i)(1)}\\
 W^{[2](i)(2)}\\
 ..\\
\end{matrix}\right),
å½¢å¼ç±»ä¼¼äº
\end{align*}
$$

****

<img src="./assets/image-20230728175356036.png" alt="image-20230728175356036" style="zoom: 60%;" />
$$
\begin{align*}
&æ‰€ä»¥ï¼Œ\\
&\quad \frac{dJ}{da^{[1]}}=\frac{1}{m} {W^{[2]}}^T (a^{[2]}-y)
={W^{[2]}}^T \frac{dJ}{dz^{[2]}},

\quad å¤§å°: (n^{[1]}\times n^{[2]}) , (n^{[2]} \times 1)\\
\end{align*}
$$

$$
\begin{align*}
&ç”±äºa^{[1]}=g(z^{[1]}),å¯¹åº”å…ƒç´ åˆ†åˆ«ä½¿ç”¨gå‡½æ•°\\
&æ‰€ä»¥ï¼Œ\frac{da^{[1](i)}}{dz^{[1](i)}}=g^{[1]'}(z^{[1](i)}) \quad => 
\quad \frac{da^{[1]}}{dz^{[1]}}=g^{[1]'}(z^{[1]}) ï¼ˆå¯¹åº”ä½ç½®çš„å¯¼æ•°ï¼‰\\
& => 
\frac{dJ}{dz^{[1]}} = \frac{dJ}{da^{[1]}} * g^{[1]'}(z^{[1]}) ï¼ˆå¯¹åº”ä½ç½®æ•°ä¹˜ï¼‰
={W^{[2]}}^T \frac{dJ}{dz^{[2]}} * g^{[1]'}(z^{[1]}) ï¼Œ


\quad å¤§å°: n^{[1]} \times 1\\
\end{align*}
$$


$$
\begin{align*}
& \quad \frac{dJ}{dW^{[1]}} = \frac{dJ}{dz^{[1]}}  \frac{dz^{[1]}}{dW^{[1]}}\\
& ç±»æ¯”å¯å¾—ï¼Œ\frac{dz^{[1]}}{dW^{[1]}}={a^{[0]}}^T=x^T,æ‰€ä»¥\\
&\quad \frac{dJ}{dW^{[1]}} = \frac{dJ}{dz^{[1]}} x^T\\
&åŒç†ï¼Œç±»æ¯”\frac{dz^{[2]}}{db^{[2]}}è®¡ç®—è¿‡ç¨‹ï¼Œå¯å¾—\\
& \quad \frac{dJ}{db^{[1]}}=\frac{dJ}{dz^{[1]}},(å¤šæ ·æœ¬æ—¶æœ‰\frac{dJ}{db^{[1]}}=\frac{1}{m}np.sum(dz^{[1]},axis=1,keepdims=True))
\end{align*}
$$



<img src="./assets/image-20230802195928548.png" alt="image-20230802195928548" style="zoom:80%;" />



##### å…¬å¼æ•´ç†ï¼š

###### æ­£å‘ä¼ é€’ï¼š

$$
z^{[i]}=W^{[i]}a^{[i-1]}+b^{[i]}\\
a^{[i]}=g^{[i]}(a^{[i]})
$$

###### åå‘ä¼ æ’­ï¼š

$$
\frac{dJ}{dz^{[i]}} = \frac{dJ}{da^{[i]}} * g^{[i]'}(a^{[i]})\\
\frac{dJ}{dW^{[i]}} = \frac{dJ}{dz^{[i]}} {a^{[i-1]}}^T\\
\frac{dJ}{db^{[i]}}= \frac{dJ}{dz^{[i]}}\\
\frac{dJ}{da^{[i-1]}}= {W^{[i]}}^T \frac{dJ}{dz^{[i]}}
$$

ç»“æœå›¾:

![image-20230822120240560](./assets/image-20230822120240560.png)



#### éšæœºåˆå§‹åŒ–ï¼š

Wéœ€è¦éšæœºåˆå§‹åŒ–ï¼Œä¸èƒ½åˆå§‹åŒ–ä¸º0ï¼Œå¦åˆ™æ‰€æœ‰èŠ‚ç‚¹éƒ½æ˜¯å¯¹ç§°çš„ï¼Œå‚æ•°å®Œå…¨ç›¸åŒï¼Œåå‘å½±å“ä¹Ÿç›¸åŒã€‚

bå¯ä»¥å…¨åˆå§‹åŒ–ä¸º0ã€‚







## 4ã€æ·±å±‚ç¥ç»ç½‘ç»œ



